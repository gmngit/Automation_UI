## Сайт для автотестов API и UI ##

### Установка ###

В идеале установить на сервер, но можно запустить и в докере.<br>
Для начала клонируйте репозиторий. <br>

#### Сборка образа ####

```commandline
docker build -t exam_srv .
```

#### Запуск контейнера ####

```commandline
docker run -it --rm --name exam_srv -p 8081:8081 exam_srv
```

Я специально добавил удаление контейнера после запуска, чтобы достаточно было перезапустить контейнер и получить пустую
базу.<br>
Вот собственно и все, можно открывать в браузере:<br>
сайт http://127.0.0.1:8081<br>
документация http://127.0.0.1:8081/api/v1/ui<br>

### Установка и запуск без докера ###

Если по какой-то причине установка и запуск из докера не доступны, можно запустить репозиторий локально.
Для начала клонируйте репозиторий:

```commandline
git clone git@github.com:GC-QAA-Edu/exam_srv.git
```

Создайте и активируйте виртуальное окружение:

```commandline
cd exam_srv
python3 -m venv .venv
```

Для Mac/Linux:

```commandline
source .venv/bin/activate
```

для Windows:

```commandline
.venv\Scripts\activate
```

Установите пакет в режиме редактирования:

```commandline
pip install -e .
```

Подготовьте сервер к запуску и запустите:

```commandline
flask db upgrade
flask add-user admin@gcore.qa zxcvbn --admin

flask run
```

Где `zxcvbn` это пароль администратора сервера, скорее всего он вам не понадобится.<br>
После запуска сервер должен быть доступен локально по адресу http://127.0.0.1:5000

### Подключение из тестов ###

Если вы используете локальный драйвер селениума, то ни каких вопросов не должно возникнуть, просто открывайте сайт
по локальному IP.<br>
Но если проделать такое через удаленный драйвер, например в докере (selenium standalone или selenoid), то не понятно,
как из контейнера адресовать хост машину.<br>
Для этого случая разработчики докера добавили в hosts специальную ссылку:

```
host.docker.internal:8081
```

Тут 8081 это просто порт на нашем хосте, где доступен сайт.

### Задание для тестирования UI ###

#### Главная страница: ####

* проверить корректность расчета стоимости серверов. <br>Формула расчета price = cpu**2 + ram*2 + ssd/4

#### Страница регистрации: ####

* проверить регистрацию по парам
    * имя/пароль,
    * email/пустой пароль
    * не корректный email/пароль. <br>
      проверить ответ по тексту уведомления об ошибке.
* проверить регистрацию по паре email/пароль
* попробовать повторно зарегистрироваться с тем же значением email/пароль, проверить ответ по тексту уведомления об
  ошибке

#### Страница авторизации ####

* попробовать авторизоваться с некорректной парой email/пароль
* авторизоваться с корректным значением email/пароль
* сравнить значение cookies[‘access_token’] до и после успешной авторизации. Должны быть разные

#### Страница профиля ####

* создать 3 сервера, проверить количество серверов на странице
* удалить 1 сервер, проверить количество серверов на странице
* создать сервер где cpu равно не числу, а строке, например “XEON”
* создать сервер с некорректным доменом, проверить ответ по всплывающему сообщению.